# Overview

## TCA 설명, 사용하는 이유

TCA(The Composable Architecture) 아키텍처는 구성, 테스트, 인체공학을 염두해두고 일관 되고 이해하기 쉬운 방식으로 애플리케이션을 빌드하기 위한 라이브러리이다. SwiftUI, UIKit에서 모두 사용될 수 있으며 UIKit은 ReactorKit 이라는것도 별도로 존재한다. TCA는 만들어질 당시에 SwiftUI를 염두해두고 만들어진 라이브러리이기 때문에 SwiftUI 에서 더욱 강력한 힘을 발휘 한다고한다.

TCA는 기존의 MVC, MVVM 의 양방향 데이터 바인딩의 문제를 해결하고 앱의 상태관리를 편리하게 하는 도구를 제공한다. 기존의 양방향 데이터 바인딩의 문제점은 데이터가 양방향으로 흘러가기 때문에 앱이 복잡해질수록 상태관리가 복잡해지고 에러의 가능성이 높아진다 하지만 TCA 아키텍처의 단방향 데이터 흐름은 정해진 흐름대로 기능을 구현하면 되기때문에 에러의 가능성을 낮추고 Side Effect를 관리하기 수월해진다.
 
### 공식문서에서 설명하는 TCA 아키텍처

**상태 관리**

- 간단한 값 유형을 사용하여 애플리케이션의 상태를 관리하고 여러 화면에서 상태를 공유하여 한 화면에서 발생한 변화를 다른 화면에서 즉시 확인할 수 있는 방법입니다.

**구성:**

- 큰 기능을 작은 구성요소로 분해하여 이를 개별적인 격리된 모듈로 추출하고 쉽게 다시 붙여 기능을 형성하는 방법입니다.

**부작용**

- 애플리케이션의 특정 부분이 가능한 가장 테스트 가능하고 이해하기 쉬운 방식으로 외부 세계와 통신하도록 하는 방법입니다.

**테스트**

- 아키텍처에 내장된 기능을 테스트하는 방법뿐만 아니라 여러 부분으로 구성된 기능에 대한 통합 테스트를 작성하고, 부작용이 애플리케이션에 어떤 영향을 미치는지 이해하기 위해 엔드투엔드 테스트를 작성하는 방법입니다. 이를 통해 비즈니스 로직이 예상대로 실행되고 있다는 강력한 보장을 할 수 있습니다.

**인체공학**
- 위의 모든 것을 가능한 한 적은 개념과 움직이는 부품을 사용하여 간단한 API로 달성하는 방법.

TCA 구조

<img src = "https://github.com/Seokki-Kwon/TCA-Study/blob/main/tca-diagram-swift-and-tips-1.png?raw=true"/>

- View: View는 State의 상태에 따라서 업데이트된다. <br/>
- Action: View에서 발생할 수 있는 인터랙션을 정의 Action에 따라서 Reducer 함수에서 실행되는 로직이 달라진다. <br/>
- Reducer: Action을 받아서 State의 상태를 변화하는 함수 <br/>
- Enviroment: 네트워크 요청과같이 외부 API 클라이언트에 의존성을 가지는 경우 <br/>
- State: View에서 사용되는 상태값(ex. 카운트, 로딩여부, Alert 여부)

Enviroment가 조금 헷갈렸다. 지금까지 이해한 내용으로는 API 요청과같은 사이드이펙트를 발생시키는 행위를 별도의 Effect를 발생시켜 다른 Action으로 그 값을 받을 수 있도록한다.

## 시작하기

### 라이브러리 설치

실제로 SwiftUI에서 TCA를 사용하기 위해서는 프로젝트에 ComposableArchitecture 라이브러리를 추가해야한다. Swift Package Manager로 [이곳에서](https://github.com/pointfreeco/swift-composable-architecture) 간단하게 설치가 가능하다.

> 설치를 하고나서 Macro를 찾을 수 없다거나 모듈을 찾을 수 없다고 나오는 문제는 Resolve Pacakage Cache와 Clean Build를 반복하여 해결했다.



